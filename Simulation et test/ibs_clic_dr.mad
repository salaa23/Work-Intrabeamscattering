! DATE AND TIME:    06/12/04  03.01.00
!
! FILE:             clicdrnew.mad                                                                   
!
ang:=2*3.141592653/100;
GRAD :=0.0;   !-3.058302E-01
LEN := 2.724721E-01;
PPN := LEN ;
GR := -2.605525E-01;
ANG := 0.06283185306;
GRAD := 0.0;
LEN := 0.2724721;
LL1 := 0.1078097;
LL2 := 0.1000031;
LL3 := 0.07005689;
LL33 := 0.14011378;
KS1Y1 := -1.077126318641E4;
KS1X2 := 8.762601512321E3;
KS3Y1 := -1.078690067568E4;
KS3X2 := 8.762602111656E3;
KS2Y1 := -1.078016140083E4;
KS2X2 := 8.762601901965E3;
KS1X3 := 8.762602063503E3;
KS2X3 := 8.762601957832E3;
KS3X3 := 8.762601481058E3;
WIGGLERPEAKFIELD := 1.764;
WIGGLERPERIOD := 0.2;
POLELENGTH := WIGGLERPERIOD/4.0;
WIGANGLE := 0.011155944;
PPN := LEN;
GR := -0.2605525;
ALFA2 := -3.561549;
BETA2 := 9.000838;
ALFA1 := 0.5725983;
BETA1 := 1.270588;

cavvol := 0.;

RF: RFCAVITY, L=1.0E-5, VOLT:=cavvol, HARMON=1800;
GTMER: SBEND, L=LEN, ANGLE=ANG/2.0, K1=GRAD, E1=0.0, E2=ANG/2.0;
GTMEL: SBEND, L=LEN, ANGLE=ANG/2.0, K1=GRAD, E1=ANG/2.0, E2=0.0;
GQF1: QUADRUPOLE, L=0.16, K1=27.25941;
KGQF1:=27.25941;
GQF2: QUADRUPOLE, L=0.1542959, K1=-16.2213;
KGQF2:=-16.2213;
M1: MARKER;
S1: DRIFT, L=LL1;
S2: DRIFT, L=LL2;
S3: DRIFT, L=LL3;
MR: MONITOR;
HKR: HKICKER;
VKR: VKICKER;
HKRF: HKICKER;
VKRF: VKICKER;
HKRD0: KICKER, HKICK=0.0, VKICK=0.0;
HKRD1: KICKER, HKICK=0.0, VKICK=0.0;
HKRD2: KICKER, HKICK=0.0, VKICK=0.0;
HKRD3: KICKER, HKICK=0.0, VKICK=0.0;
VKRD1: KICKER, HKICK=0.0, VKICK=0.0;
VKRD2: KICKER, HKICK=0.0, VKICK=0.0;
VKRD3: KICKER, HKICK=0.0, VKICK=0.0;
VKRD4: KICKER, HKICK=0.0, VKICK=0.0;
XGQF1: QUADRUPOLE, L=0.16, K1=KGQF1;
XGQF2: QUADRUPOLE, L=0.1542959, K1=KGQF2;
S1X2: SEXTUPOLE, L=LL2, K2=KS1X2;
S1Y1: SEXTUPOLE, L=LL3, K2=KS1Y1;
S1X3: SEXTUPOLE, L=LL2, K2=KS1X3;
S2X2: SEXTUPOLE, L=LL2, K2=KS2X2;
S2Y1: SEXTUPOLE, L=LL3, K2=KS2Y1;
S2X3: SEXTUPOLE, L=LL2, K2=KS2X3;
S3X2: SEXTUPOLE, L=LL2, K2=KS3X2;
S3Y1: SEXTUPOLE, L=LL3, K2=KS3Y1;
S3X3: SEXTUPOLE, L=LL2, K2=KS3X3;
WIGPOLEPOS: RBEND, L=POLELENGTH, ANGLE=WIGANGLE;
WIGPOLENEG: RBEND, L=POLELENGTH, ANGLE=-WIGANGLE;
WIGHALFPOLEPOS: RBEND, L=POLELENGTH/2.0, ANGLE=WIGANGLE/2.0;
WIGHALFPOLENEG: RBEND, L=POLELENGTH/2.0, ANGLE=-WIGANGLE/2.0;
WIGDRIFT: DRIFT, L=POLELENGTH;
LWIGDRIFT: DRIFT, L=2.0;
QFW: QUADRUPOLE, TYPE=FODO, L=0.2, K1=3.916979;
QDW: QUADRUPOLE, TYPE=FODO, L=0.2, K1=-3.103432;
QFWW: QUADRUPOLE, TYPE=FODO, L=0.2, K1=3.916979;
LQFW: QUADRUPOLE, TYPE=FODO, L=0.2, K1=3.916979;
LQDW: QUADRUPOLE, TYPE=FODO, L=0.2, K1=-3.103432;
WD: DRIFT, L=0.05;
W1: MARKER;
W2: MARKER;
W3: MARKER;
WMARKWIGCENTRAL: MARKER;
PPTME: SBEND, L=PPN, ANGLE=ANG/2.0, K1=GR, E1=ANG/4.0, E2=ANG/4.0, K2=0.0;
PGQF1: QUADRUPOLE, TYPE=DIS, L=0.1812258, K1=23.47001;
LPGQF1: QUADRUPOLE, TYPE=DIS, L=0.1812258, K1=23.11715;
PGQF2: QUADRUPOLE, TYPE=DIS, L=0.1542959, K1=-14.07053;
LPGQF2: QUADRUPOLE, TYPE=DIS, L=0.1542959, K1=-13.08651;
PGLD1: DRIFT, L=0.102776;
LPGLD1: DRIFT, L=0.1606605;
PGLD2: DRIFT, L=0.138878;
LPGLD2: DRIFT, L=0.0724657;
PCLIC: DRIFT, L=0.1554253;
M2: MARKER;
PSS1: SEXTUPOLE, L=0.06833055, K2=0.0;
PSS2: SEXTUPOLE, L=0.1872414, K2=0.0;
PS1: SEXTUPOLE, L=0.1545425, K2=0.0;
PS2: SEXTUPOLE, L=0.1509784, K2=0.0;
PS3: SEXTUPOLE, L=0.1493434, K2=0.0;
BQ1: QUADRUPOLE, TYPE=DIS, L=0.2, K1=-6.809154;
BQ2: QUADRUPOLE, TYPE=DIS, L=0.2, K1=9.369839;
B1: DRIFT, L=0.5999877;
B2: DRIFT, L=0.2573545;
B3: DRIFT, L=0.4080515;
ZQFW: QUADRUPOLE, L=0.2, K1=-2.424129;
ZQDW: QUADRUPOLE, L=0.2, K1=-2.434141;
ZWD: DRIFT, L=0.1674582;
M7: MARKER;
M3: MARKER;
M4: MARKER;
M5: MARKER;
M6: MARKER;
M8: MARKER;
M9: MARKER;
M10: MARKER;
M11: MARKER;
M12: MARKER;
T1: MARKER;
T2: MARKER;
T3: MARKER;
T4: MARKER;
HKRA1: KICKER, HKICK=0.0, VKICK=0.0;
HKRA2: KICKER, HKICK=0.0, VKICK=0.0;
VKRA1: KICKER, HKICK=0.0, VKICK=0.0;
P1: MARKER;
P2: MARKER;
P3: MARKER;
P4: MARKER;
P5: MARKER;
P6: MARKER;
P7: MARKER;
P8: MARKER;
D1: MARKER;
D2: MARKER;
D3: MARKER;
D4: MARKER;
D5: MARKER;
D6: MARKER;
D7: MARKER;
D8: MARKER;
A1: MARKER;
A2: MARKER;
A3: MARKER;
A4: MARKER;
A5: MARKER;
A6: MARKER;
A7: MARKER;
A8: MARKER;
D12: MARKER;
F1: MARKER;
F2: MARKER;
F3: MARKER;
F4: MARKER;
G1: MARKER;
G2: MARKER;
G3: MARKER;
G4: MARKER;
QQ: QUADRUPOLE, L=0.0, K1=0.0;
ACELL: LINE=(GTMER,S1,GQF1,HKR,MR,S2,GQF2,S3,VKR,S3,GQF2,S2,GQF1,HKR,MR,S1,
GTMEL);
WIGGLER1: LINE=(WIGHALFPOLEPOS,WIGDRIFT,WIGPOLENEG,WIGDRIFT,WIGPOLEPOS,
WIGDRIFT,WIGPOLENEG,WIGDRIFT,WIGPOLEPOS,WMARKWIGCENTRAL,WIGDRIFT,WIGPOLENEG,
WIGDRIFT,WIGPOLEPOS,WIGDRIFT,WIGPOLENEG,WIGDRIFT,WIGPOLEPOS,WIGDRIFT,
WIGPOLENEG,WIGDRIFT,WIGPOLEPOS,WIGDRIFT,WIGPOLENEG,WIGDRIFT,WIGPOLEPOS,
WIGDRIFT,WIGPOLENEG,WIGDRIFT,WIGPOLEPOS,WIGDRIFT,WIGPOLENEG,WIGDRIFT,
WIGPOLEPOS,WIGDRIFT,WIGPOLENEG,WIGDRIFT,WIGPOLEPOS,WIGDRIFT,WIGPOLENEG,
WIGDRIFT,WIGHALFPOLEPOS);
FODOWPP: LINE=(W1,QFW,HKRF,MR,WD,WIGGLER1,WD,QDW,VKRF,MR,WD,WIGGLER1,WD,W2);
LFODOWPP: LINE=(W1,LQFW,HKRF,MR,WD,WIGGLER1,WD,LQDW,VKRF,MR,WD,WIGGLER1,WD,
W2);
ESUPP: LINE=(M1,GTMER,PGLD1,PGQF1,PGLD2,PGQF2,PCLIC,LPGQF2,LPGLD2,LPGQF1,
LPGLD1,PPTME,M2);
SESUPP: LINE=(M1,GTMER,PSS1,MR,PGQF1,HKRD1,PS1,PGQF2,PS2,VKRD1,MR,LPGQF2,PS3,
LPGQF1,HKRD2,MR,PSS2,PPTME,M2);
SESUPPL: LINE=(M2,PPTME,PSS2,MR,LPGQF1,HKRD1,PS3,LPGQF2,PS2,VKRD1,MR,PGQF2,
PS1,PGQF1,HKRD2,MR,PSS1,GTMER,M1);
MINS: LINE=(B1,BQ1,VKRD2,MR,B2,BQ2,HKRD3,MR,B3,ZQFW,VKRD3,MR,ZWD,WIGGLER1,
ZWD,ZQDW,VKRD4,MR,ZWD,WIGGLER1,ZWD);
MINSL: LINE=(HKRD0,MR,ZWD,WIGGLER1,ZWD,ZQDW,VKRD4,MR,ZWD,WIGGLER1,ZWD,ZQFW,
VKRD3,MR,B3,BQ2,HKRD3,MR,B2,BQ1,VKRD2,MR,B1);
RMINS: LINE=(B1,BQ1,VKRD2,MR,B2,BQ2,HKRD3,MR,B3,RF,ZQFW,VKRD3,MR,ZWD,
WIGGLER1,ZWD,ZQDW,VKRD4,MR,ZWD,WIGGLER1,ZWD);
NSUPP: LINE=(SESUPP,M7,MINS);
NSUPPL: LINE=(QFWW,MINSL,SESUPPL);
RFNSUPP: LINE=(SESUPP,RMINS);
A1CELL: LINE=(GTMER,S1,MR,GQF1,HKR,S1X2,GQF2,S1Y1,VKR,MR,S1Y1,GQF2,S1X3,GQF1,
HKR,MR,S1,GTMEL);
A2CELL: LINE=(GTMER,S1,MR,GQF1,HKR,S2X2,GQF2,S2Y1,VKR,MR,S2Y1,GQF2,S2X3,GQF1,
HKR,MR,S1,GTMEL);
A3CELL: LINE=(GTMER,S1,MR,GQF1,HKR,S3X2,GQF2,S3Y1,VKR,MR,S3Y1,GQF2,S3X3,GQF1,
HKR,MR,S1,GTMEL);
XA1CELL: LINE=(GTMER,S1,MR,XGQF1,HKR,S1X2,XGQF2,S1Y1,VKR,MR,S1Y1,XGQF2,S1X3,
XGQF1,HKR,MR,S1,GTMEL);
XA2CELL: LINE=(GTMER,S1,MR,XGQF1,HKR,S2X2,XGQF2,S2Y1,VKR,MR,S2Y1,XGQF2,S2X3,
XGQF1,HKR,MR,S1,GTMEL);
XA3CELL: LINE=(GTMER,S1,MR,XGQF1,HKR,S3X2,XGQF2,S3Y1,VKR,MR,S3Y1,XGQF2,S3X3,
XGQF1,HKR,MR,S1,GTMEL);
ARCELL: LINE=(GTMER,S1,MR,GQF1,HKR,S1X2,GQF2,S1Y1,VKR,MR,GQF2,S1X3,GQF1,HKR,
MR,S1,GTMEL);
SACELL: LINE=(A1CELL,A2CELL,A3CELL);
XSACELL: LINE=(XA1CELL,XA2CELL,XA3CELL);
RR: LINE=(M9,99*A2CELL,M12,A2CELL,RF);
RS: LINE=(M1,RF,MR,ARCELL,M2,98*ARCELL,P1,M3,ARCELL,MR,M4);
WIGGLERS6: LINE=(FODOWPP,FODOWPP,FODOWPP,W2,FODOWPP,FODOWPP,W3,FODOWPP);
WIGGLERS5: LINE=(FODOWPP,FODOWPP,FODOWPP,W2,FODOWPP,FODOWPP,W3);
WIGGLERS4: LINE=(FODOWPP,FODOWPP,FODOWPP,FODOWPP);
WIGGLERS3: LINE=(FODOWPP,FODOWPP,FODOWPP);
D: LINE=(SESUPP);
AEI: LINE=(NSUPP);
RING: LINE=(15*SACELL,G1,SACELL,A1,NSUPP,A2,2*FODOWPP,F1,13*FODOWPP,F2,2*
FODOWPP,A3,NSUPPL,A4,XSACELL,G2,14*XSACELL,RF,G3,XSACELL,D1,NSUPP,D2,2*
LFODOWPP,F3,13*LFODOWPP,F4,2*LFODOWPP,D3,NSUPPL,D4);
RING1: LINE=(A2,16*SACELL);
RING2: LINE=(A1,A2,WIGGLERS4,10*FODOWPP,WIGGLERS3,A3,A4);
RING3: LINE=(A1,96*HKR,48*VKR,17*HKRF,17*VKRF,A2,16*XSACELL);
RING4: LINE=(A1,192*HKR,96*VKR,17*HKRF,17*VKRF,A2,3*LFODOWPP,11*LFODOWPP,3*
LFODOWPP,A3,A4);
ANG := 0.06283185306;
GRAD := 0.0;
LEN := 0.2724721;
LL1 := 0.1078097;
LL2 := 0.1000031;
LL3 := 0.07005689;
LL33 := 0.14011378;
KS1Y1 := -1.077126318641E4;
KS1X2 := 8.762601512321E3;
KS3Y1 := -1.078690067568E4;
KS3X2 := 8.762602111656E3;
KS2Y1 := -1.078016140083E4;
KS2X2 := 8.762601901965E3;
KS1X3 := 8.762602063503E3;
KS2X3 := 8.762601957832E3;
KS3X3 := 8.762601481058E3;
WIGGLERPEAKFIELD := 1.764;
WIGGLERPERIOD := 0.2;
POLELENGTH := WIGGLERPERIOD/4.0;
WIGANGLE := 0.011155944;
PPN := LEN;
GR := -0.2605525;
ALFA2 := -3.561549;
BETA2 := 9.000838;
ALFA1 := 0.5725983;
BETA1 := 1.270588;
QX := 72.6900416187;
QY := 35.418018915238;
QS := 0.0
QX' := 1.608633355698;
QY' := 0.37712957789;
ALFX := -0.490551000298E-3;
ALFY := 0.50168539198E-3;
BETX := 0.111767960289;
BETY := 0.593025318188;
X0 := 0.0;
PX0 := 0.0;
Y0 := 0.0;
PY0 := 0.0;
T0 := 0.0;
PT0 := 0.0;
Q1 := 0.6900416187;
Q2 := 0.418018915238;
! Q1' := 1.608633360831;
! Q2' := 0.37712957789;
! Q1'' := -91.854230762594;
! Q2'' := 6.72252765756E2;
! DQ1DE1 := -3.424451430457E4;
! DQ2DE2 := 1.438228437753E7;
! DQ1DE2 := -2.715209971574E5;

! return ; 

beam, particle=positron, energy=2.424,bunched,npart=3.1E+09, 
      kbunch=1386, EX = 1.20E-10, EY = 6.75E-13 ,
      ET=1.6e-6,SIGT=0.00162, SIGE=0.00128; !,radiate ;

use,period=ring;

select,flag=error,class=quadrupole;
ealign,dphi=0.0002*tgauss(3.0);

select, flag=twiss, clear;
select, flag=twiss, column=name,s,dx,dy; 
twiss,file=optics;

! select, flag=twiss, clear;
twiss,table,file;

twiss, save;
plot,haxis=s,vaxis=dx,dy;

ibs, file ; 

stop; 



! 
cavvol := 2.5;
beam, particle=positron, energy=2.424,bunched,npart=3.1E+09, 
      kbunch=1386, EX = 1.07E-10, EY = 6.41E-13 ,
      ET=2.65e-6,SIGT=0.00214, SIGE=0.00124; !,radiate ;


select, flag=twiss, clear;
twiss,chrom,table,file;

touschek,file,uloss=2.192;

a=table(touschek,tli);
value,a;

!
! return ;
!
! 
cavvol := 3.0;
beam, particle=positron, energy=2.424,bunched,npart=3.1E+09, 
      kbunch=1386, EX = 1.26E-10, EY = 7.59E-13 ,
      ET=1.82e-6,SIGT=0.0014, SIGE=0.0013; !,radiate ;

select, flag=twiss, clear;
! twiss,chrom,table,file;

! touschek,file,uloss=2.192;
! a=table(touschek,tli);
! value,a;



return ;

! 
cavvol := 3.5;
beam, particle=positron, energy=2.424,bunched,npart=3.1E+09, 
      kbunch=1386, EX = 1.33E-10, EY = 7.99E-13 ,
      ET=1.61e-6,SIGT=0.001214, SIGE=0.001324; !,radiate ;

select, flag=twiss, clear;
twiss,chrom,table,file;

touschek,file,uloss=2.192;

a=table(touschek,tli);
value,a;

! 
cavvol := 4.0;
beam, particle=positron, energy=2.424,bunched,npart=3.1E+09, 
      kbunch=1386, EX = 1.39E-10, EY = 8.31E-13 ,
      ET=1.477e-6,SIGT=0.001104, SIGE=0.001338; !,radiate ;

select, flag=twiss, clear;
twiss,chrom, table,file;

touschek,file,uloss=2.192;

a=table(touschek,tli);
value,a;

! 
cavvol := 4.5;
beam, particle=positron, energy=2.424,bunched,npart=3.1E+09, 
      kbunch=1386, EX = 1.427E-10, EY = 8.56E-13 ,
      ET=1.377e-6,SIGT=0.00102, SIGE=0.00135; !,radiate ;

select, flag=twiss, clear;
twiss,chrom,table,file;

touschek,file
! ,uloss=2.192;

a=table(touschek,tli);
value,a;

return ; 

use,period=ring;

select, flag=twiss, clear;
twiss,table,file;

touschek,file,uloss=2.192;

a=table(touschek,tli);
value,a;

stop



